-- Variables
local player = game.Players.LocalPlayer
local mouse = player:GetMouse()
local loopingStomp = false
local loopingZone = false
local selectedPlayer = nil
local hoverSelectEnabled = false

-- Create GUI
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "UtilityToolsGUI"
screenGui.Parent = game.CoreGui

local mainFrame = Instance.new("Frame")
mainFrame.Size = UDim2.new(0, 250, 0, 350)
mainFrame.Position = UDim2.new(0, 20, 0, 20)
mainFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
mainFrame.BorderSizePixel = 2
mainFrame.BorderColor3 = Color3.fromRGB(50, 50, 50)
mainFrame.Parent = screenGui

local title = Instance.new("TextLabel")
title.Text = "Utility Tools"
title.Size = UDim2.new(0, 250, 0, 50)
title.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
title.TextColor3 = Color3.fromRGB(255, 255, 255)
title.Font = Enum.Font.GothamBold
title.TextSize = 24
title.TextScaled = true
title.Parent = mainFrame

-- Draggable GUI
local dragging, dragInput, dragStart, startPos
mainFrame.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        dragging = true
        dragStart = input.Position
        startPos = mainFrame.Position
    end
end)
mainFrame.InputChanged:Connect(function(input)
    if dragging and input.UserInputType == Enum.UserInputType.MouseMovement then
        local delta = input.Position - dragStart
        mainFrame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
    end
end)
mainFrame.InputEnded:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        dragging = false
    end
end)

-- Create Buttons
local function createButton(name, yPos, callback)
    local button = Instance.new("TextButton")
    button.Size = UDim2.new(0, 230, 0, 40)
    button.Position = UDim2.new(0, 10, 0, yPos)
    button.BackgroundColor3 = Color3.fromRGB(45, 45, 45)
    button.TextColor3 = Color3.fromRGB(255, 255, 255)
    button.Text = name
    button.Font = Enum.Font.Gotham
    button.TextSize = 18
    button.TextScaled = true
    button.Parent = mainFrame
    button.MouseEnter:Connect(function()
        button.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
    end)
    button.MouseLeave:Connect(function()
        button.BackgroundColor3 = Color3.fromRGB(45, 45, 45)
    end)
    button.MouseButton1Click:Connect(callback)
    return button
end

-- Input Box
local inputBox = Instance.new("TextBox")
inputBox.Size = UDim2.new(0, 230, 0, 40)
inputBox.Position = UDim2.new(0, 10, 0, 70)
inputBox.BackgroundColor3 = Color3.fromRGB(45, 45, 45)
inputBox.TextColor3 = Color3.fromRGB(255, 255, 255)
inputBox.PlaceholderText = "Enter Player Name"
inputBox.Font = Enum.Font.Gotham
inputBox.TextSize = 18
inputBox.TextScaled = true
inputBox.Parent = mainFrame

-- Stomp Function
local function stompTarget()
    if selectedPlayer and selectedPlayer.Name ~= "wrd2davi" and selectedPlayer.Character and selectedPlayer.Character:FindFirstChild("HumanoidRootPart") then
        local pos = selectedPlayer.Character.HumanoidRootPart.Position
        game.ReplicatedStorage.Events.Gameplay.HitStomp:FireServer(pos, {selectedPlayer})
    end
end

-- Auto Looping Stomp
task.spawn(function()
    while true do
        if loopingStomp and selectedPlayer and selectedPlayer.Name ~= "wrd2davi" then
            stompTarget()
        end
        task.wait(1)
    end
end)

-- Auto Looping Zone
task.spawn(function()
    while true do
        if loopingZone then
            game.ReplicatedStorage.Events.Other.ChangeZoneIn:FireServer("Hacked Boxing")
        end
        task.wait(1)
    end
end)

-- Hover Select
createButton("Hover Select", 120, function()
    hoverSelectEnabled = not hoverSelectEnabled
    inputBox.Text = hoverSelectEnabled and "Hover Select Enabled" or "Hover Select Disabled"
end)

-- Toggle Auto-Stomp
createButton("Auto-Stomp", 170, function()
    loopingStomp = not loopingStomp
end)

-- Toggle Auto-Zone
createButton("Auto-Zone", 220, function()
    loopingZone = not loopingZone
end)

-- Teleport
createButton("Teleport to Location", 270, function()
    player.Character.HumanoidRootPart.CFrame = CFrame.new(75, 40, 393)
end)

-- Hover select input
mouse.Button1Down:Connect(function()
    if hoverSelectEnabled then
        local target = mouse.Target
        if target then
            local model = target:FindFirstAncestorOfClass("Model")
            local plr = game.Players:GetPlayerFromCharacter(model)
            if plr then
                selectedPlayer = plr
                inputBox.Text = selectedPlayer.Name
                hoverSelectEnabled = false
            end
        end
    end
end)

-- Keybind for Hover Select
game:GetService("UserInputService").InputBegan:Connect(function(input, gameProcessed)
    if not gameProcessed and input.KeyCode == Enum.KeyCode.P then
        hoverSelectEnabled = true
        inputBox.Text = "Hover: Select a player"
    end
end)

-- Set display name for wrd2davi
for _, plr in pairs(game.Players:GetPlayers()) do
    if plr.Name == "wrd2davi" then
        plr.DisplayName = "[ðŸ‘‘] wrd2davi"
    end
end

-- Chat command system
player.Chatted:Connect(function(msg)
    local args = msg:split(" ")
    local command = args[1]:lower()
    if command == ":fling" and args[2] then
        local target = game.Players:FindFirstChild(args[2])
        if target and target.Character and target.Character:FindFirstChild("HumanoidRootPart") then
            local root = target.Character.HumanoidRootPart
            root.Velocity = Vector3.new(0, 100, 0)
        end
    elseif command == ":control" and args[2] then
        local target = game.Players:FindFirstChild(args[2])
        if target and target.Character then
            local myChar = player.Character
            if myChar and myChar:FindFirstChild("HumanoidRootPart") then
                myChar:MoveTo(target.Character.HumanoidRootPart.Position)
            end
        end
    elseif command == ":speed" and args[2] then
        local speed = tonumber(args[2])
        if speed and player.Character and player.Character:FindFirstChild("Humanoid") then
            player.Character.Humanoid.WalkSpeed = speed
        end
    elseif command == ":invisible" then
        for _, v in pairs(player.Character:GetDescendants()) do
            if v:IsA("BasePart") then
                v.Transparency = 1
                if v:FindFirstChild("face") then
                    v.face.Transparency = 1
                end
            end
        end
    elseif command == ":jump" and args[2] then
        local power = tonumber(args[2])
        if power and player.Character and player.Character:FindFirstChild("Humanoid") then
            player.Character.Humanoid.JumpPower = power
        end
    end
end)
